<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Compressor de Imagens</title>
  <style>
    body { font-family: Arial; max-width: 600px; margin: auto; padding: 2em; }
    .progress { width: 100%; background: #eee; border-radius: 5px; overflow: hidden; }
    .bar { height: 20px; background: #4caf50; width: 0%; transition: width 0.4s ease; }
  </style>
</head>
<body>
  <h2>Compressor de Imagens (até 10 ficheiros)</h2>
  <input type="file" id="fileInput" accept="image/png, image/jpeg" multiple>
  <button onclick="uploadImages()">Comprimir</button>
  <div class="progress"><div id="bar" class="bar"></div></div>
  <div id="status"></div>

  <script>
    async function uploadImages() {
      const input = document.getElementById('fileInput');
      const files = input.files;
      const status = document.getElementById('status');
      const bar = document.getElementById('bar');

      if (!files.length || files.length > 10) {
        alert("Seleciona entre 1 e 10 imagens.");
        return;
      }

      const formData = new FormData();
      for (let i = 0; i < files.length; i++) {
        formData.append('images', files[i]);
      }

      bar.style.width = '10%';
      status.innerText = "A processar imagens...";

      try {
        const response = await fetch('https://compressor-api.onrender.com/upload', {
          method: 'POST',
          body: formData
        });

        if (!response.ok) throw new Error("Erro ao processar imagens");

        const blob = await response.blob();
        bar.style.width = '100%';
        status.innerText = "Compressão concluída. A descarregar...";

        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'imagens_comprimidas.zip';
        a.click();

        status.innerText = "Transferência concluída.";
      } catch (err) {
        status.innerText = "Erro: " + err.message;
      }
    }
  </script>
</body>
</html>
